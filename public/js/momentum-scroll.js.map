{"version":3,"sources":["node_modules/browser-pack/_prelude.js","src/index.js","momentum-scroll.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length","1","module","Momentum","this","round","RAF","momentums","inited","running","formatTransform","key","value","unit","$document","$","document","prototype","init","createMomentums","window","on","onScroll","bind","stop","cancelAnimationFrame","parent","each","index","el","$el","data","momentum","element","datas","isArray","forEach","makeDefaults","addMomentum","push","windowHeight","height","scrollFrom","Math","max","offset","top","scrollDistance","floor","scrollTo","smoothness","prev","current","props","defaultProp","parseFloat","toString","replace","indexOf","css","noSmooth","scroll","scrollTop","applyProperties","cssTransform","j","scrollCurrent","min","prop","next","val","ceil","requestAnimationFrame"],"mappings":"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","file":"momentum-scroll.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","/**\n * Suported props:\n *\n * transform:\n * translateX(2em);\n * translateY(3in);\n * scaleX(2);\n * scaleY(0.5);\n * rotate(0.5turn);\n * skewX(30deg);\n * skewY(1.07rad);\n * translateZ(2px);\n * scaleZ(0.3);\n * rotateX(10deg);\n * rotateY(10deg);\n * rotateZ(10deg);\n * perspective(17px);\n *\n * Other:\n * Opacity\n */\n\nvar $document = $(document);\n\nfunction Momentum() {\n  /* PUBLIC VARIABLES */\n  this.round = 1000;\n\n  /* PRIVATE VARIABLES */\n  this.RAF = null;\n  this.momentums = [];\n  this.inited = false;\n  this.running = 0;\n}\n\nMomentum.prototype.init = function init() {\n  if (this.inited) {\n    this.inited = true;\n    return;\n  }\n\n  // TODO Allow this to be dynamic\n  // if user choses not to init, have him be able to create the onscroll event\n  this.createMomentums();\n\n  $(window).on('scroll', function() {\n    // Restart script if we stopped it\n    if (this.running) return;\n    this.onScroll();\n  }.bind(this));\n\n  this.onScroll(true);\n}\n\nMomentum.prototype.stop = function stop() {\n  window.cancelAnimationFrame(this.RAF);\n}\n\n/**\n * Creates momentum instances from data attributes.\n * Can pass a context to scope the function.\n * @public\n */\nMomentum.prototype.createMomentums = function createMomentums(parent) {\n  parent = parent || '';\n  // Destroys old momentums (let GC clean up)\n  this.momentums.length = 0;\n  $(parent + ' [data-momentum]').each(function(index, el) {\n    // TODO Put this in own function?\n    var $el = $(el);\n    var data = $el.data('momentum');\n    var momentum = {\n      element: $el,\n      datas: [],\n    }\n\n    if ($.isArray(data)) {\n      momentum.datas = data;\n      momentum.datas.forEach(function(data) {\n        this.makeDefaults($el, data);\n      }.bind(this));\n      this.addMomentum(momentum);\n    } else {\n      momentum.datas.push(data);\n      this.makeDefaults($el, momentum.datas[0]);\n      this.addMomentum(momentum);\n    }\n  }.bind(this));\n}\n\nMomentum.prototype.makeDefaults = function makeDefaults($el, data) {\n  var windowHeight = $(window).height();\n  data.scrollFrom = data['from-scroll'] || Math.max(0, $el.offset().top - windowHeight);\n  // TODO: Accept other units such as % (percent of element like transform), vh, vw, etc.\n  data.scrollDistance = data['distance'] || $el.height() + windowHeight;\n  data.scrollDistance = Math.max(Math.floor(data.scrollDistance), 1);\n  data.scrollTo = data['to-scroll'] || data.scrollFrom + data.scrollDistance;\n  data.smoothness = data['smoothness'] || 30;\n\n  data.prev = {};\n  data.current = {};\n\n  for (key in data.props) {\n    var defaultProp = 0;\n    var value = parseFloat(data.props[key], 10);\n    var unit = data.props[key].toString().replace(/[-\\d\\.]/g, '');\n    if (key.indexOf('scale') === 0 || key === 'opacity') {\n      defaultProp = 1;\n    }\n    // XXX: Wouldn't it be better for the user to set this himself\n    // rather than have unexpected behavior?\n    if (key === 'translateZ') {\n      $el.parent().css('perspective', 800 || data.perspective);\n    }\n\n\n    // TODO:\n    // Make the element start halfway down, meet at it's origin in\n    // the center of the screen distance (by default).\n    var end = value / 2;\n    var start = end - value;\n    data.prev[key] = defaultProp;\n    data.props[key] = { value: value, unit: unit };\n    data.current[key] = { value: value, unit: unit };\n    // TODO Get current computated style\n    // Will have to convert and match units\n  };\n\n}\n\nMomentum.prototype.addMomentum = function addMomentum(momentum) {\n  this.momentums.push(momentum);\n}\n\nMomentum.prototype.onScroll = function onScroll(noSmooth) {\n  this.running = 0;\n  // XXX: Since on scroll is actually called when not scrolling\n  // we could possibly cache this somewhere and save some cycles.\n  var scroll = $document.scrollTop();\n\n  for (var i = 0; i < this.momentums.length; ++i) {\n    var momentum = this.momentums[i];\n    var applyProperties = false;\n    var cssTransform = '';\n\n    for (var j = 0; j < momentum.datas.length; ++j) {\n      var data = momentum.datas[j];\n      var smoothness = data.smoothness;\n      if (noSmooth || smoothness === 0) smoothness = 1;\n\n      var scrollCurrent = scroll;\n      scrollCurrent = Math.max(scrollCurrent, data.scrollFrom);\n      scrollCurrent = Math.min(scrollCurrent, data.scrollTo);\n\n      for (var prop in data.props) {\n        var value = data.props[prop].value;\n        var unit = data.props[prop].unit;\n\n        // TODO: Put this in the momentum object?\n        var defaultProp = 0;\n        if (prop.indexOf('scale') === 0 || prop === 'opacity') {\n          defaultProp = 1;\n        }\n\n        var next = (value - defaultProp) * (scrollCurrent - data.scrollFrom) / (data.scrollTo - data.scrollFrom) + defaultProp;\n        var val = data.prev[prop] + (next - data.prev[prop]) / smoothness;\n        val = Math.ceil(val * this.round) / this.round;\n\n        // what does this do?\n        // Probably caps the value\n        if (val === data.prev[prop] && next === value) val = value;\n        data.current[prop].value = val;\n\n        if (prop === 'opacity') {\n          momentum.element.css('opacity', data.current[prop].value);\n        } else {\n          cssTransform += formatTransform(prop, data.current[prop].value, data.current[prop].unit);\n        }\n        if (data.prev[prop] !== data.current[prop].value) {\n          data.prev[prop] = data.current[prop].value;\n          this.running++;\n          applyProperties = true;\n        }\n      }\n    }\n    if (applyProperties) {\n      this.running++;\n      momentum.element.css('transform', cssTransform);\n    }\n  }\n  if (this.running === 0) {\n    this.stop();\n    return;\n  }\n  this.RAF = window.requestAnimationFrame(this.onScroll.bind(this, false));\n}\n\nfunction formatTransform(key, value, unit) {\n  return key + '(' + value + unit + ') ';\n}\n\nvar momentum = new Momentum();\nmomentum.init();\n","(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n/**\n * Suported props:\n *\n * transform:\n * translateX(2em);\n * translateY(3in);\n * scaleX(2);\n * scaleY(0.5);\n * rotate(0.5turn);\n * skewX(30deg);\n * skewY(1.07rad);\n * translateZ(2px);\n * scaleZ(0.3);\n * rotateX(10deg);\n * rotateY(10deg);\n * rotateZ(10deg);\n * perspective(17px);\n *\n * Other:\n * Opacity\n */\n\nvar $document = $(document);\n\nfunction Momentum() {\n  /* PUBLIC VARIABLES */\n  this.round = 1000;\n\n  /* PRIVATE VARIABLES */\n  this.RAF = null;\n  this.momentums = [];\n  this.inited = false;\n  this.running = 0;\n}\n\nMomentum.prototype.init = function init() {\n  if (this.inited) {\n    this.inited = true;\n    return;\n  }\n\n  // TODO Allow this to be dynamic\n  // if user choses not to init, have him be able to create the onscroll event\n  this.createMomentums();\n\n  $(window).on('scroll', function() {\n    // Restart script if we stopped it\n    if (this.running) return;\n    this.onScroll();\n  }.bind(this));\n\n  this.onScroll(true);\n}\n\nMomentum.prototype.stop = function stop() {\n  window.cancelAnimationFrame(this.RAF);\n}\n\n/**\n * Creates momentum instances from data attributes.\n * Can pass a context to scope the function.\n * @public\n */\nMomentum.prototype.createMomentums = function createMomentums(parent) {\n  parent = parent || '';\n  // Destroys old momentums (let GC clean up)\n  this.momentums.length = 0;\n  $(parent + ' [data-momentum]').each(function(index, el) {\n    // TODO Put this in own function?\n    var $el = $(el);\n    var data = $el.data('momentum');\n    var momentum = {\n      element: $el,\n      datas: [],\n    }\n\n    if ($.isArray(data)) {\n      momentum.datas = data;\n      momentum.datas.forEach(function(data) {\n        this.makeDefaults($el, data);\n      }.bind(this));\n      this.addMomentum(momentum);\n    } else {\n      momentum.datas.push(data);\n      this.makeDefaults($el, momentum.datas[0]);\n      this.addMomentum(momentum);\n    }\n  }.bind(this));\n}\n\nMomentum.prototype.makeDefaults = function makeDefaults($el, data) {\n  var windowHeight = $(window).height();\n  data.scrollFrom = data['from-scroll'] || Math.max(0, $el.offset().top - windowHeight);\n  // TODO: Accept other units such as % (percent of element like transform), vh, vw, etc.\n  data.scrollDistance = data['distance'] || $el.height() + windowHeight;\n  data.scrollDistance = Math.max(Math.floor(data.scrollDistance), 1);\n  data.scrollTo = data['to-scroll'] || data.scrollFrom + data.scrollDistance;\n  data.smoothness = data['smoothness'] || 30;\n\n  data.prev = {};\n  data.current = {};\n\n  for (key in data.props) {\n    var defaultProp = 0;\n    var value = parseFloat(data.props[key], 10);\n    var unit = data.props[key].toString().replace(/[-\\d\\.]/g, '');\n    if (key.indexOf('scale') === 0 || key === 'opacity') {\n      defaultProp = 1;\n    }\n    // XXX: Wouldn't it be better for the user to set this himself\n    // rather than have unexpected behavior?\n    if (key === 'translateZ') {\n      $el.parent().css('perspective', 800 || data.perspective);\n    }\n\n\n    // TODO:\n    // Make the element start halfway down, meet at it's origin in\n    // the center of the screen distance (by default).\n    var end = value / 2;\n    var start = end - value;\n    data.prev[key] = defaultProp;\n    data.props[key] = { value: value, unit: unit };\n    data.current[key] = { value: value, unit: unit };\n    // TODO Get current computated style\n    // Will have to convert and match units\n  };\n\n}\n\nMomentum.prototype.addMomentum = function addMomentum(momentum) {\n  this.momentums.push(momentum);\n}\n\nMomentum.prototype.onScroll = function onScroll(noSmooth) {\n  this.running = 0;\n  // XXX: Since on scroll is actually called when not scrolling\n  // we could possibly cache this somewhere and save some cycles.\n  var scroll = $document.scrollTop();\n\n  for (var i = 0; i < this.momentums.length; ++i) {\n    var momentum = this.momentums[i];\n    var applyProperties = false;\n    var cssTransform = '';\n\n    for (var j = 0; j < momentum.datas.length; ++j) {\n      var data = momentum.datas[j];\n      var smoothness = data.smoothness;\n      if (noSmooth || smoothness === 0) smoothness = 1;\n\n      var scrollCurrent = scroll;\n      scrollCurrent = Math.max(scrollCurrent, data.scrollFrom);\n      scrollCurrent = Math.min(scrollCurrent, data.scrollTo);\n\n      for (var prop in data.props) {\n        var value = data.props[prop].value;\n        var unit = data.props[prop].unit;\n\n        // TODO: Put this in the momentum object?\n        var defaultProp = 0;\n        if (prop.indexOf('scale') === 0 || prop === 'opacity') {\n          defaultProp = 1;\n        }\n\n        var next = (value - defaultProp) * (scrollCurrent - data.scrollFrom) / (data.scrollTo - data.scrollFrom) + defaultProp;\n        var val = data.prev[prop] + (next - data.prev[prop]) / smoothness;\n        val = Math.ceil(val * this.round) / this.round;\n\n        // what does this do?\n        // Probably caps the value\n        if (val === data.prev[prop] && next === value) val = value;\n        data.current[prop].value = val;\n\n        if (prop === 'opacity') {\n          momentum.element.css('opacity', data.current[prop].value);\n        } else {\n          cssTransform += formatTransform(prop, data.current[prop].value, data.current[prop].unit);\n        }\n        if (data.prev[prop] !== data.current[prop].value) {\n          data.prev[prop] = data.current[prop].value;\n          this.running++;\n          applyProperties = true;\n        }\n      }\n    }\n    if (applyProperties) {\n      this.running++;\n      momentum.element.css('transform', cssTransform);\n    }\n  }\n  if (this.running === 0) {\n    this.stop();\n    return;\n  }\n  this.RAF = window.requestAnimationFrame(this.onScroll.bind(this, false));\n}\n\nfunction formatTransform(key, value, unit) {\n  return key + '(' + value + unit + ') ';\n}\n\nvar momentum = new Momentum();\nmomentum.init();\n\n},{}]},{},[1])\n\n"],"sourceRoot":"/source/"}